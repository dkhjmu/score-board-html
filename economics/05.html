<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5ë‹¨ê³„: ì„±ì¥ë¥ ê³¼ ì£¼ê°€ (Turn-based)</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --value-color: #27ae60; /* ê°€ì¹˜: ì´ˆë¡ */
            --price-color: #e74c3c; /* ê°€ê²©: ë¹¨ê°• */
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Jua', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { margin-bottom: 5px; }
        p.subtitle { color: #7f8c8d; margin-bottom: 20px; text-align: center; }

        .game-container {
            background: white;
            width: 100%;
            max-width: 600px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            padding: 25px;
        }

        /* ì°¨íŠ¸ ì˜ì—­ */
        .chart-wrapper {
            width: 100%;
            height: 300px;
            background-color: #fcfcfc;
            border: 1px solid #eee;
            border-radius: 10px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        svg { width: 100%; height: 100%; }

        .line-value {
            fill: none;
            stroke: var(--value-color);
            stroke-width: 3;
            stroke-dasharray: 5, 5; /* ì ì„  */
        }

        .line-price {
            fill: none;
            stroke: var(--price-color);
            stroke-width: 3;
            stroke-linejoin: round;
        }

        .dot { r: 4; }
        .dot-value { fill: var(--value-color); }
        .dot-price { fill: var(--price-color); }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            background-color: #f1f2f6;
            padding: 20px;
            border-radius: 15px;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: #dcdde1;
            outline: none;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .btn-next {
            width: 100%;
            padding: 15px;
            background-color: var(--text-color);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .btn-next:active { transform: scale(0.98); }
        .btn-next:disabled { background-color: #bdc3c7; cursor: not-allowed; }

        /* ìƒíƒœ í‘œì‹œ */
        .status-board {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        .stat-item b { font-size: 1.1rem; display: block; }
        .val-text { color: var(--value-color); }
        .pri-text { color: var(--price-color); }

        .news-ticker {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 0.9rem;
            margin-bottom: 15px;
            min-height: 20px;
        }

    </style>
</head>
<body>

<h1>5ë‹¨ê³„: ì£¼ì¸ê³¼ ê°•ì•„ì§€ (ì‹¤ì „)</h1>
<p class="subtitle">ì„±ì¥ë¥ ì„ ì •í•˜ê³  'ë‹¤ìŒ í•´'ë¡œ ë„˜ê²¨ë³´ì„¸ìš”.</p>

<div class="game-container">

    <div class="status-board">
        <div class="stat-item val-text">
            ì£¼ì¸ (ê¸°ì—…ê°€ì¹˜)
            <b id="dispValue">10,000ì›</b>
        </div>
        <div class="stat-item pri-text">
            ê°•ì•„ì§€ (ì£¼ê°€)
            <b id="dispPrice">10,000ì›</b>
        </div>
        <div class="stat-item">
            í˜„ì¬
            <b id="dispYear">0ë…„ì°¨</b>
        </div>
    </div>

    <div id="newsBox" class="news-ticker">íˆ¬ìë¥¼ ì‹œì‘í•©ë‹ˆë‹¤! ì„±ì¥ë¥ ì„ ì •í•´ì£¼ì„¸ìš”.</div>

    <div class="chart-wrapper">
        <svg id="chartSvg" viewBox="0 0 600 300">
            <line x1="0" y1="150" x2="600" y2="150" stroke="#eee" stroke-width="1"/>

            <path id="pathValue" class="line-value" d="M0 150" />
            <path id="pathPrice" class="line-price" d="M0 150" />

            <circle id="dotValue" class="dot dot-value" cx="0" cy="150" />
            <circle id="dotPrice" class="dot dot-price" cx="0" cy="150" />
        </svg>
    </div>

    <div class="control-panel">
        <div class="slider-header">
            <label>ğŸ“ˆ ì˜¬í•´ ì„±ì¥ ëª©í‘œ</label>
            <span id="growthDisplay" style="color:#2980b9;">+10% (ì„±ì¥)</span>
        </div>

        <input type="range" id="growthSlider" min="-10" max="30" step="1" value="3">

        <button id="btnNext" class="btn-next" onclick="nextYear()">ğŸ“… 1ë…„ ë³´ë‚´ê¸° (Next)</button>
    </div>

</div>

<script>
    // ìƒíƒœ ë³€ìˆ˜
    let year = 0;
    const maxYears = 30;

    let currentValue = 10000; // ì‹œì‘ ê°€ì¹˜
    let currentPrice = 10000; // ì‹œì‘ ì£¼ê°€

    // ë°ì´í„° ì €ì¥ ë°°ì—´ (ì°¨íŠ¸ ê·¸ë¦¬ê¸°ìš©)
    let historyValue = [10000];
    let historyPrice = [10000];

    // DOM ìš”ì†Œ
    const growthSlider = document.getElementById('growthSlider');
    const growthDisplay = document.getElementById('growthDisplay');
    const btnNext = document.getElementById('btnNext');
    const newsBox = document.getElementById('newsBox');

    const dispValue = document.getElementById('dispValue');
    const dispPrice = document.getElementById('dispPrice');
    const dispYear = document.getElementById('dispYear');

    const chartSvg = document.getElementById('chartSvg');
    const pathValue = document.getElementById('pathValue');
    const pathPrice = document.getElementById('pathPrice');
    const dotValue = document.getElementById('dotValue');
    const dotPrice = document.getElementById('dotPrice');

    // ìŠ¬ë¼ì´ë” ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
    growthSlider.addEventListener('input', function() {
        const val = parseInt(this.value);
        if(val > 0) {
            growthDisplay.innerText = `+${val}% (ì„±ì¥)`;
            growthDisplay.style.color = '#e74c3c'; // ë¹¨ê°• (ìƒìŠ¹ ëŠë‚Œ)
        } else if (val < 0) {
            growthDisplay.innerText = `${val}% (ì—­ì„±ì¥)`;
            growthDisplay.style.color = '#2980b9'; // íŒŒë‘ (í•˜ë½ ëŠë‚Œ)
        } else {
            growthDisplay.innerText = `0% (ìœ ì§€)`;
            growthDisplay.style.color = '#333';
        }
    });

    // ì½¤ë§ˆ í¬ë§·
    function formatMoney(num) {
        return Math.round(num).toLocaleString();
    }

    // [í•µì‹¬] ë‹¤ìŒ í•´ë¡œ ë„˜ì–´ê°€ê¸°
    function nextYear() {
        if (year >= maxYears) {
            alert("30ë…„ íˆ¬ìê°€ ëë‚¬ìŠµë‹ˆë‹¤! ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.");
            return;
        }

        year++;

        // 1. ì‚¬ìš©ìê°€ ì •í•œ ì„±ì¥ë¥  ì ìš© (ê°€ì¹˜ ë³€í™”)
        const growthRate = parseInt(growthSlider.value) / 100;
        currentValue = currentValue * (1 + growthRate);

        // 2. ì‹œì¥ì˜ ê´‘ê¸° ì ìš© (ì£¼ê°€ ë³€í™”)
        // ì£¼ê°€ëŠ” ê°€ì¹˜ë¥¼ ë”°ë¼ê°€ë ¤ê³  í•˜ì§€ë§Œ(0.7), ëœë¤ ë…¸ì´ì¦ˆ(0.3)ê°€ ì„ì„
        // ë…¸ì´ì¦ˆ: -20% ~ +20% ì‚¬ì´ì˜ ëœë¤ ë³€ë™
        const noise = (Math.random() - 0.5) * 0.4;

        // ëª©í‘œ ì£¼ê°€ = í˜„ì¬ ê°€ì¹˜ * (1 + ë…¸ì´ì¦ˆ)
        // í•˜ì§€ë§Œ í•œ ë²ˆì— ë‹¤ ë°˜ì˜ë˜ì§€ ì•Šê³ , ì´ì „ ì£¼ê°€ì™€ì˜ ê´€ì„±ë„ ìˆìŒ
        const targetPrice = currentValue * (1 + noise);
        currentPrice = currentPrice + (targetPrice - currentPrice) * 0.8; // 80% ë°˜ì˜

        // ë‰´ìŠ¤ ìƒì„± (ë…¸ì´ì¦ˆì— ë”°ë¥¸ í…ìŠ¤íŠ¸)
        if (noise > 0.15) {
            newsBox.innerText = `ğŸ”¥ [ë‰´ìŠ¤] ì‹œì¥ì´ í¥ë¶„í–ˆìŠµë‹ˆë‹¤! ì£¼ê°€ê°€ ê°€ì¹˜ë³´ë‹¤ í›¨ì”¬ ë¹„ì‹¸ê²Œ ê±°ë˜ë©ë‹ˆë‹¤.`;
            newsBox.style.background = "#ffcdd2"; // ë¶‰ì€ìƒ‰ ë°°ê²½
        } else if (noise < -0.15) {
            newsBox.innerText = `â„ï¸ [ë‰´ìŠ¤] ê³µí¬ê°ì´ ë•ë‹ˆë‹¤. íšŒì‚¬ëŠ” íŠ¼íŠ¼í•œë° ì£¼ê°€ë§Œ ë–¨ì–´ì§€ë„¤ìš”. (ì €ê°€ ë§¤ìˆ˜ ê¸°íšŒ?)`;
            newsBox.style.background = "#c5cae9"; // í‘¸ë¥¸ìƒ‰ ë°°ê²½
        } else {
            newsBox.innerText = `ğŸƒ [ë‰´ìŠ¤] ì‹œì¥ì´ í‰ì˜¨í•©ë‹ˆë‹¤. ì£¼ê°€ê°€ ê¸°ì—… ê°€ì¹˜ë¥¼ ì˜ ë”°ë¼ê°€ê³  ìˆë„¤ìš”.`;
            newsBox.style.background = "#f0f2f5";
        }

        // ë°ì´í„° ì €ì¥
        historyValue.push(currentValue);
        historyPrice.push(currentPrice);

        // UI ì—…ë°ì´íŠ¸
        updateUI();
        drawChart();
    }

    function updateUI() {
        dispValue.innerText = formatMoney(currentValue) + 'ì›';
        dispPrice.innerText = formatMoney(currentPrice) + 'ì›';
        dispYear.innerText = year + 'ë…„ì°¨';

        if (year >= maxYears) {
            btnNext.innerText = "íˆ¬ì ì¢…ë£Œ (ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”)";
            btnNext.disabled = true;
        }
    }

    function drawChart() {
        // 1. ìŠ¤ì¼€ì¼ë§ (í™”ë©´ì— ê½‰ ì°¨ê²Œ ë³´ì´ê¸° ìœ„í•´ ìµœëŒ€/ìµœì†Œê°’ ê³„ì‚°)
        const allValues = [...historyValue, ...historyPrice];
        const minVal = Math.min(...allValues) * 0.9; // ì—¬ë°± 10%
        const maxVal = Math.max(...allValues) * 1.1; // ì—¬ë°± 10%

        // SVG ì¢Œí‘œ ë³€í™˜ í•¨ìˆ˜
        // Xì¶•: 0 ~ 600 (20ë…„ ê¸°ì¤€)
        // Yì¶•: 300 ~ 0 (ê°’ ê¸°ì¤€, SVGëŠ” ìœ„ê°€ 0ì´ë¯€ë¡œ ë°˜ì „ í•„ìš”)

        const getX = (index) => (index / maxYears) * 600;
        const getY = (val) => 300 - ((val - minVal) / (maxVal - minVal)) * 300;

        // ì„  ê·¸ë¦¬ê¸° (Path ë°ì´í„° ìƒì„±)
        let dVal = "", dPri = "";

        historyValue.forEach((val, i) => {
            const x = getX(i);
            const y = getY(val);
            if (i === 0) dVal += `M ${x} ${y}`;
            else dVal += ` L ${x} ${y}`;
        });

        historyPrice.forEach((val, i) => {
            const x = getX(i);
            const y = getY(val);
            if (i === 0) dPri += `M ${x} ${y}`;
            else dPri += ` L ${x} ${y}`;
        });

        pathValue.setAttribute('d', dVal);
        pathPrice.setAttribute('d', dPri);

        // í˜„ì¬ ìœ„ì¹˜ ì  ì°ê¸° (ë§ˆì§€ë§‰ ë°ì´í„°)
        const lastIdx = historyValue.length - 1;
        const lastX = getX(lastIdx);

        dotValue.setAttribute('cx', lastX);
        dotValue.setAttribute('cy', getY(historyValue[lastIdx]));

        dotPrice.setAttribute('cx', lastX);
        dotPrice.setAttribute('cy', getY(historyPrice[lastIdx]));
    }

    // ì´ˆê¸°ê°’ ì„¸íŒ…
    growthDisplay.innerText = "+10% (ì„±ì¥)";
</script>
</body>
</html>